{"version":3,"sources":["../../src/pages/profile/profile.module.ts","../../src/pages/profile/profile.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ProfilePage } from './profile';\n\n@NgModule({\n  declarations: [\n    ProfilePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ProfilePage),\n  ],\n})\nexport class ProfilePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile/profile.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Loading, AlertController, Platform, ActionSheetController, ToastController } from 'ionic-angular';\nimport { Observable } from 'rxjs/Observable';\nimport { Profile } from '../../models/profile/profile.interface';\nimport { DataService } from '../../providers/data.service';\nimport { User } from 'firebase/app';\nimport { LoadingController } from 'ionic-angular/components/loading/loading-controller';\nimport { StorageService } from '../../providers/storage.service';\nimport { Camera } from '@ionic-native/camera';\nimport { Subscription } from 'rxjs/Subscription';\nimport { AuthService } from '../../providers/auth.service';\n\n@IonicPage()\n@Component({\n  selector: 'page-profile',\n  templateUrl: 'profile.html',\n})\nexport class ProfilePage {\n\n  profile = {} as Profile;\n  loadingProfile: Subscription;\n  loading: Loading;\n  isCore: boolean;\n  photo: string;\n\n  constructor(\n    private navCtrl: NavController,\n    private camera: Camera,\n    private platform: Platform,\n    private toastCtrl: ToastController,\n    private actionSheetCtrl: ActionSheetController,\n    private loadingCtrl: LoadingController,\n    private alertCtrl: AlertController,\n    private auth: AuthService,\n    private data: DataService,\n    private storage: StorageService\n  ) {\n    if (this.platform.is('core') || (this.platform.is('mobileweb'))) {\n      this.isCore = true;\n    }\n  }\n\n  showLoader(content) {\n    if (!this.loading) {\n      this.loading = this.loadingCtrl.create({\n        content: content\n      });\n      this.loading.present();\n    }\n  }\n\n  dismissLoader() {\n    if (this.loading) {\n      this.loading.dismiss();\n      this.loading = null;\n    }\n  }\n\n  showAlert(message) {\n    this.alertCtrl.create({\n      title: `An error occured!`,\n      message: message,\n      buttons: ['OK'],\n      enableBackdropDismiss: false\n    }).present();\n  }\n\n  showToast(message) {\n    this.toastCtrl.create({\n      message: message,\n      duration: 3000,\n      showCloseButton: true\n    }).present();\n  }\n\n  onDisplayPicture() {\n    if (!this.isCore) {\n      this.actionSheetCtrl.create({\n        buttons: [\n          {\n            text: 'Take Photo',\n            handler: () => {\n              this.takePhoto();\n            }\n          },\n          {\n            text: 'From Gallery',\n            handler: () => {\n              this.selectPhoto();\n            }\n          },\n          {\n            text: 'Cancel',\n            role: 'cancel'\n          }\n        ]\n      }).present();\n    }\n  }\n\n  async takePhoto() {\n    this.showLoader('Please wait...');\n    try {\n      const image = await this.camera.getPicture({\n        quality: 50,\n        destinationType: this.camera.DestinationType.DATA_URL,\n        sourceType: this.camera.PictureSourceType.CAMERA,\n        encodingType: this.camera.EncodingType.JPEG,\n        mediaType: this.camera.MediaType.PICTURE,\n        saveToPhotoAlbum: false,\n        targetHeight: 500,\n        targetWidth: 500\n      });\n\n      this.photo = 'data:image/png;base64,' + image;\n      this.dismissLoader();\n      this.uploadPhoto();\n    }\n    catch (e) {\n      console.error(e);\n      this.showAlert(e.message || 'Error getting photo information');\n      this.dismissLoader();\n    }\n  }\n\n  async selectPhoto() {\n    try {\n      this.showLoader('Please wait...');\n      const image = await this.camera.getPicture({\n        sourceType: this.camera.PictureSourceType.SAVEDPHOTOALBUM,\n        destinationType: this.camera.DestinationType.DATA_URL,\n        quality: 50,\n        encodingType: this.camera.EncodingType.JPEG,\n        mediaType: this.camera.MediaType.PICTURE,\n        targetHeight: 500,\n        targetWidth: 500\n      });\n\n      this.photo = 'data:image/png;base64,' + image;\n      this.dismissLoader();\n      this.uploadPhoto();\n    }\n    catch (e) {\n      console.error(e);\n      this.showAlert(e.message || 'Error getting photo information');\n      this.dismissLoader();\n    }\n  }\n\n  async onChangePhoto($event: any) {\n    this.showLoader('Please wait...');\n    let reader = new FileReader();\n    reader.onload = () => {\n      this.dismissLoader();\n      this.photo = reader.result;\n      this.uploadPhoto();\n    };\n    reader.readAsDataURL((<HTMLInputElement>event.target).files[0]);\n  }\n\n  async uploadPhoto() {\n    this.showLoader('Uploading photo...');\n    const snapshot = await this.storage.uploadBase64Image(this.photo, `profile`, `profile-picture`);\n    this.dismissLoader();\n\n    if (!snapshot) {\n      this.showAlert('Error uploading profile picture!');\n    } else {\n      // update the user profile with the snapshot download URL\n      const result = await this.data.updateUserAvatar(this.auth.getUid(), snapshot['downloadURL']);\n      if (result) {\n        this.showToast('Avatar updated');\n      } else {\n        this.showAlert('Error updating avatar!');\n      }\n    }\n    this.refreshProfile();\n  }\n\n  async save() {\n    this.showLoader('Saving profile...');\n    let result = await this.data.saveUserProfile(this.auth.getUid(), this.profile);\n    if(!result) {\n      this.showAlert('Error saving profile!');\n    } else {\n      this.showToast('Profile updated!');\n    }\n    this.dismissLoader();\n  }\n\n  refreshProfile() {\n    let uid = this.auth.getUid();\n\n    if(uid) {\n      this.loadingProfile = this.data.getUserProfile(uid).subscribe((profile: Profile) => {\n        this.loadingProfile.unsubscribe();\n        this.profile = profile;\n      });\n    }\n  }\n\n  ionViewWillLoad() {\n    this.refreshProfile();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile/profile.ts"],"sourceRoot":""}