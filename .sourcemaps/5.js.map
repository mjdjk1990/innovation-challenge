{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/login/login.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACZ;AAUpC;IAAA;IAA8B,CAAC;IAAlB,eAAe;QAR3B,uEAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,yDAAS;aACV;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,yDAAS,CAAC;aACpC;SACF,CAAC;OACW,eAAe,CAAG;IAAD,sBAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZc;AAC4D;AAI3C;AACA;AAS3D;IAWE,mBACU,OAAsB,EACtB,IAAiB,EACjB,IAAiB,EACjB,WAA8B,EAC9B,SAA0B;QALpC,iBAUC;QATS,YAAO,GAAP,OAAO,CAAe;QACtB,SAAI,GAAJ,IAAI,CAAa;QACjB,SAAI,GAAJ,IAAI,CAAa;QACjB,gBAAW,GAAX,WAAW,CAAmB;QAC9B,cAAS,GAAT,SAAS,CAAiB;QAdpC,YAAO,GAAG,EAAa,CAAC;QAExB,mBAAc,GAAY,IAAI,CAAC;QAc7B,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE,CAAC,SAAS,CAAC,UAAC,IAAU;YAC9E,KAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;QAChC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,8BAAU,GAAV;QACE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAClB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;gBACrC,OAAO,EAAE,eAAe;aACzB,CAAC,CAAC;YACH,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;QACzB,CAAC;IACH,CAAC;IAED,iCAAa,GAAb;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YACjB,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;YACvB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACtB,CAAC;IACH,CAAC;IAED,6BAAS,GAAT,UAAU,OAAO;QACf,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACpB,KAAK,EAAE,mBAAmB;YAC1B,OAAO,EAAE,OAAO;YAChB,OAAO,EAAE,CAAC,IAAI,CAAC;YACf,qBAAqB,EAAE,KAAK;SAC7B,CAAC,CAAC,OAAO,EAAE,CAAC;IACf,CAAC;IAEK,yBAAK,GAAX;;;;;;;wBACE,IAAI,CAAC,UAAU,EAAE,CAAC;wBACI,qBAAM,IAAI,CAAC,IAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,OAAO,CAAC;;wBAAxE,aAAa,GAAG,SAAwD;wBAE9E,EAAE,CAAC,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;4BACzB,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE,CAAC,SAAS,CAAC,cAAI;gCACvE,IAAI,CAAC,MAAM,EAAE,CAAC;gCAEd,gBAAgB;gCAChB,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;oCACvB,KAAI,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,iBAAO;wCAClE,0BAA0B;wCAC1B,qEAAqE;wCACrE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;4CACb,KAAI,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,EAAE;gDAClC,SAAS,EAAE,IAAI;gDACf,QAAQ,EAAE,IAAI;gDACd,MAAM,EAAE,IAAI;gDACZ,KAAK,EAAE,IAAI,CAAC,KAAK;gDACjB,MAAM,EAAE,IAAI;6CACb,CAAC,CAAC;wCACL,CAAC;wCACD,6EAA6E;wCAC7E,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;wCAC9B,KAAI,CAAC,aAAa,EAAE,CAAC;oCACvB,CAAC,CAAC,CAAC;gCACL,CAAC;gCAAC,IAAI,CAAC,CAAC;oCACN,KAAI,CAAC,aAAa,EAAE,CAAC;oCACrB,KAAI,CAAC,SAAS,CAAC,qEAAqE,CAAC,CAAC;gCACxF,CAAC;4BACH,CAAC,CAAC,CAAC;wBACL,CAAC;wBAAC,IAAI,CAAC,CAAC;4BACN,IAAI,CAAC,aAAa,EAAE,CAAC;4BACrB,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;wBACnG,CAAC;;;;;KACF;IAED,0CAAsB,GAAtB;QACE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;IACpC,CAAC;IAED,mCAAe,GAAf;QACE,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;IACxC,CAAC;IA3FU,SAAS;QAJrB,wEAAS,CAAC;YACT,QAAQ,EAAE,YAAY;WACG;SAC1B,CAAC;yFAagC;YAChB,4EAAW;YACX,wEAAW;YACJ,wEAAiB;YACnB,MAAe;OAhBzB,SAAS,CA6FrB;IAAD,CAAC;AAAA;SA7FY,SAAS,e","file":"5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LoginPage } from './login';\n\n@NgModule({\n  declarations: [\n    LoginPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LoginPage),\n  ],\n})\nexport class LoginPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Loading, LoadingController, AlertController } from 'ionic-angular';\nimport { Subscription } from 'rxjs/Subscription';\nimport { User } from 'firebase/app';\nimport { Account } from '../../models/account/account.interface';\nimport { AuthService } from '../../providers/auth.service';\nimport { DataService } from '../../providers/data.service';\nimport { Observable } from 'rxjs/Observable';\nimport { Profile } from '../../models/profile/profile.interface';\n\n@IonicPage()\n@Component({\n  selector: 'page-login',\n  templateUrl: 'login.html',\n})\nexport class LoginPage {\n\n  account = {} as Account;\n  loading: Loading;\n  passwordHidden: boolean = true;\n\n  authenticatedUser$: Subscription;\n  authenticatedUser: User;\n\n  profile: Observable<any>;\n\n  constructor(\n    private navCtrl: NavController,\n    private auth: AuthService,\n    private data: DataService,\n    private loadingCtrl: LoadingController,\n    private alertCtrl: AlertController,\n  ) {\n    this.authenticatedUser$ = this.auth.getAuthenticatedUser().subscribe((user: User) => {\n      this.authenticatedUser = user;\n    });\n  }\n\n  showLoader() {\n    if (!this.loading) {\n      this.loading = this.loadingCtrl.create({\n        content: 'Signing in...'\n      });\n      this.loading.present();\n    }\n  }\n\n  dismissLoader() {\n    if (this.loading) {\n      this.loading.dismiss();\n      this.loading = null;\n    }\n  }\n\n  showAlert(message) {\n    this.alertCtrl.create({\n      title: `An error occured!`,\n      message: message,\n      buttons: ['OK'],\n      enableBackdropDismiss: false\n    }).present();\n  }\n\n  async login() {\n    this.showLoader();\n    const loginResponse = await this.auth.signInWithEmailAndPassword(this.account);\n\n    if (!loginResponse.error) {\n      this.authenticatedUser$ = this.auth.getAuthenticatedUser().subscribe(user => {\n        user.reload();\n\n        // user verified\n        if (user.emailVerified) {\n          this.data.getUserProfile(loginResponse.result.uid).subscribe(profile => {\n            // check for profile data.\n            // if no profile go to create profile page, otherwise go to main page\n            if (!profile) {\n              this.data.saveUserProfile(user.uid, {\n                firstName: null,\n                lastName: null,\n                avatar: null,\n                email: user.email,\n                office: null\n              });\n            }\n            //profile ? this.navCtrl.push('HomePage') : this.navCtrl.push('ProfilePage');\n            this.navCtrl.push('TabsPage');\n            this.dismissLoader();\n          });\n        } else {\n          this.dismissLoader();\n          this.showAlert('Email verification required. Please verify your email and try again');\n        }\n      });\n    } else {\n      this.dismissLoader();\n      this.showAlert(loginResponse.error.message.substr(loginResponse.error.message.indexOf(\":\") + 1));\n    }\n  }\n\n  navigateToRegisterPage() {\n    this.navCtrl.push('RegisterPage');\n  }\n\n  ionViewDidLeave() {\n    this.authenticatedUser$.unsubscribe();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}